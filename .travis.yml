language: go
go: 1.5
env:
  global:
  - CABALVER=1.22
  - GHCVER=7.10.1
  - HAPPYVER=1.19.5
  - ALEXVER=3.1.4
before_install:
- travis_retry sudo add-apt-repository -y ppa:hvr/ghc
- travis_retry sudo apt-get update
- travis_retry sudo apt-get install cabal-install-$CABALVER ghc-$GHCVER
- export PATH=/opt/ghc/$GHCVER/bin:/opt/cabal/$CABALVER/bin:$PATH
- travis_retry sudo apt-get install alex-$ALEXVER
- export PATH=/opt/alex/$ALEXVER/bin:$PATH
- travis_retry sudo apt-get install happy-$HAPPYVER
- export PATH=/opt/happy/$HAPPYVER/bin:$PATH
- cabal update
script:
- cabal sandbox init
- cabal install --enable-tests --only-dependencies
- cabal configure --enable-tests
- cabal test
- VERSION=$TRAVIS_TAG make dist
cache:
  directories:
    - .cabal-sandbox
deploy:
  provider: releases
  api_key:
    secure: f8vgUN0ng9BWeBO/WcNzIS11BDDyNF/qFHqs0WsxHnausDAC91O1VPEayDpNE5MUHIgLDgLGVl7NE34lHvVTnTVkC2drM8pXVVSSaS+ZSkaCajeMZ82nK30OK36MwUXpOu6FJ/zkRX+8hiQbysRemTvh+w4xXNTb7eBBMs+50wFmxB6oon3zLcd9uR1N8QQ9Vxor8Mb7W5KIkjFnUHPrxfw1KByUw+6rgug+OYoDRSLSCmxiULzPRWeHbKdtGvd9kNhXQQc9KCc8UGfkG0C/TPBdtXqRDoQ/4Szevy6zK8wNK/FyMuKAw1JtX7qy7IBtsQgkavqDKEz61+CxppBN92q+aWcS6QxuJ0nHhtJ82dWNRiM5/xoEC96/tHOgXU/VDNtfZttT68AwWurU4dgZxBwUPzcps2x+R076CVnyQZ+84m1KTTzFr0xCyI+rglmHca1REfqYdZ3/th6WRXUMjHROO6mM9ZNK4EgAAGRVJVYBsdIneMSjklaD32fgfmZnMqxKhOqWe2cOzK7yhrOy8BdUnIG8D7ihM2wyS3n/VG7FWI2LwZrZ7doV1v32wgLeCN0Eqqu5Gbx26BBCOD7k30ik7iGAd0VnDQ10vE6ccLNY9ACZYXdXMLLOBjuZ9UWFc3Udm5M5Z1vjCq0D0AGcTohHeSA4VA/LaaiDDM/pCEU=
  file: dist/oden-$TRAVIS_TAG-$TRAVIS_OS_NAME.tar.gz
  on:
    tags: true
    repo: oden-lang/oden
